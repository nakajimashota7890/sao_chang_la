// ==UserScript==
// @name         h-a-p-p-y-t-o-o-n
// @namespace    https://github.com/nakajimashota7890/sao_chang_la/raw/main/h-a-p-p-y-t-o-o-n.user.js
// @version      2024.08.19
// @description  down h-a-p-p-y-t-o-o-n
// @author       You
// @match        https://happytoon01.com/webtoon/view/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=happytoon01.com
// @require      https://cdn.jsdelivr.net/npm/@zip.js/zip.js@2.7.48/dist/zip.min.js
// @downloadURL  https://github.com/nakajimashota7890/sao_chang_la/raw/main/h-a-p-p-y-t-o-o-n.user.js
// @updateURL    https://github.com/nakajimashota7890/sao_chang_la/raw/main/h-a-p-p-y-t-o-o-n.meta.js
// ==/UserScript==

(function(_0x5eeba5,_0x2f8077){const _0x345c5a=a0_0x4cf1,_0x559fba=_0x5eeba5();while(!![]){try{const _0x8ed469=parseInt(_0x345c5a(0x1ab))/0x1*(-parseInt(_0x345c5a(0x1b9))/0x2)+parseInt(_0x345c5a(0x19c))/0x3*(-parseInt(_0x345c5a(0x177))/0x4)+parseInt(_0x345c5a(0x192))/0x5*(parseInt(_0x345c5a(0x1ac))/0x6)+parseInt(_0x345c5a(0x1bb))/0x7*(-parseInt(_0x345c5a(0x1af))/0x8)+-parseInt(_0x345c5a(0x17b))/0x9*(parseInt(_0x345c5a(0x1a0))/0xa)+parseInt(_0x345c5a(0x179))/0xb*(-parseInt(_0x345c5a(0x187))/0xc)+parseInt(_0x345c5a(0x198))/0xd;if(_0x8ed469===_0x2f8077)break;else _0x559fba['push'](_0x559fba['shift']());}catch(_0x3d952e){_0x559fba['push'](_0x559fba['shift']());}}}(a0_0x126f,0xcdc89));let downloading_current=0x0,downloading_total=0x0,image_blobs;function sleep(_0x842a3d){return new Promise(_0x4af668=>setTimeout(_0x4af668,_0x842a3d));}function a0_0x4cf1(_0x225eaa,_0x3e9717){const _0x126f1d=a0_0x126f();return a0_0x4cf1=function(_0x4cf1d2,_0x1edd38){_0x4cf1d2=_0x4cf1d2-0x16f;let _0x3f7fe5=_0x126f1d[_0x4cf1d2];return _0x3f7fe5;},a0_0x4cf1(_0x225eaa,_0x3e9717);}const download=async(_0x2c0065,_0x1f4882)=>{const _0x161118=a0_0x4cf1,_0x34a97c=await fetch(_0x2c0065),_0x332280=await _0x34a97c[_0x161118(0x199)]();let _0x571faa=(''+(_0x1f4882+0x1))['padStart'](0x3,'0');const _0x340258=new DataView(_0x332280),_0x30f8b4=_0x340258[_0x161118(0x175)](0x0,![])[_0x161118(0x1ba)](0x10);if(_0x30f8b4===_0x161118(0x178)){const _0x4abb3f=new Blob([_0x332280],{'type':_0x161118(0x1b5)});image_blobs['push']({'name':_0x571faa+_0x161118(0x189),'blob':_0x4abb3f}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}else{if(_0x30f8b4===_0x161118(0x1a4)){const _0x214254=new Blob([_0x332280],{'type':_0x161118(0x17f)});image_blobs[_0x161118(0x1a9)]({'name':_0x571faa+_0x161118(0x191),'blob':_0x214254}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}else{const _0x4b360b=new Blob([_0x332280],{'type':_0x161118(0x1c6)});image_blobs[_0x161118(0x1a9)]({'name':_0x571faa+_0x161118(0x174),'blob':_0x4b360b}),downloading_current+=0x1,downloading_current===downloading_total&&off_heartbeat_css(),update_status();}}};function update_status(){const _0x4caf87=a0_0x4cf1;document[_0x4caf87(0x1bc)]('.status-num')[_0x4caf87(0x19d)][_0x4caf87(0x18f)]=_0x4caf87(0x1b4),document[_0x4caf87(0x1bc)](_0x4caf87(0x195))[_0x4caf87(0x19d)][_0x4caf87(0x17a)]='center',document[_0x4caf87(0x1bc)]('.status-num')[_0x4caf87(0x1b3)]=downloading_current+_0x4caf87(0x19f)+downloading_total;}function create_status_box(){const _0x599a3b=a0_0x4cf1;let _0x5652c1=document[_0x599a3b(0x1ae)](_0x599a3b(0x1b0));return _0x5652c1[_0x599a3b(0x1c5)]=_0x599a3b(0x1b6),_0x5652c1[_0x599a3b(0x1b1)]=downloading_current+_0x599a3b(0x19f)+downloading_total,_0x5652c1;}function create_download_icon(){const _0x3e40af=a0_0x4cf1;let _0x2daddf=document['createElement'](_0x3e40af(0x1b0)),_0x4179e0=document['createElement']('img');_0x4179e0[_0x3e40af(0x1c5)]='tai-ve',_0x4179e0[_0x3e40af(0x1ad)](_0x3e40af(0x182),_0x3e40af(0x19b)),_0x4179e0[_0x3e40af(0x19d)][_0x3e40af(0x1c2)]='3rem',_0x4179e0[_0x3e40af(0x19d)][_0x3e40af(0x17e)]='pointer',_0x2daddf['appendChild'](_0x4179e0);let _0x2a3b44=document[_0x3e40af(0x1ae)](_0x3e40af(0x1bd));_0x2a3b44[_0x3e40af(0x18c)]=_0x3e40af(0x1a3),_0x2a3b44[_0x3e40af(0x17d)]='https://fonts.googleapis.com/css2?family=Acme&display=swap',document[_0x3e40af(0x196)]('head')[0x0][_0x3e40af(0x1c3)](_0x2a3b44);let _0xbe21e4=document['createElement'](_0x3e40af(0x1b0));_0xbe21e4[_0x3e40af(0x1c5)]=_0x3e40af(0x19e),_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x18f)]='flex',_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x171)]=_0x3e40af(0x1a5),_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x17a)]='center',_0xbe21e4[_0x3e40af(0x19d)]['gap']='1.5rem',_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x176)]=_0x3e40af(0x173),_0xbe21e4['style']['zIndex']=_0x3e40af(0x186),_0xbe21e4['style']['top']='0.5rem',_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x18e)]='50vw',_0xbe21e4[_0x3e40af(0x19d)][_0x3e40af(0x1be)]='translate(-50%)';let _0x5bfeb0=create_status_box();const _0x397d3f=document[_0x3e40af(0x1ae)](_0x3e40af(0x19d));_0x397d3f[_0x3e40af(0x1b1)]=_0x3e40af(0x1b2),document[_0x3e40af(0x180)][_0x3e40af(0x1c3)](_0x397d3f),_0xbe21e4[_0x3e40af(0x1c3)](_0x2daddf),_0xbe21e4[_0x3e40af(0x1c3)](_0x5bfeb0);let _0xed964=document['querySelector'](_0x3e40af(0x1c1)),_0x451e3e=_0xed964[_0x3e40af(0x17c)];return _0xed964[_0x3e40af(0x16f)](_0xbe21e4,_0x451e3e),_0xbe21e4;}function a0_0x126f(){const _0x1fcb0c=['name','left','display','\x0a\x20\x20\x20\x20\x20\x20.tai-ve\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20animation:\x20heartbeat\x202s\x20infinite;\x20/*\x20Apply\x20the\x20heartbeat\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform-origin:\x20center;\x0a\x20\x20\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20\x20\x20@keyframes\x20heartbeat\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x200%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Start\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2025%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2025%\x20of\x20the\x20animation\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2050%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1.2);\x20/*\x20Scale\x20up\x20at\x2050%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20Return\x20to\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x2075%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x200.7;\x20/*\x20Fade\x20out\x20slightly\x20at\x2075%\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20100%\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20transform:\x20scale(1);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20opacity:\x201;\x20/*\x20End\x20with\x20full\x20opacity\x20*/\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20','.png','1356620RMqNgH','.zip','querySelectorAll','.status-num','getElementsByTagName','addEventListener','53704443faWvcR','arrayBuffer','all','https://github.com/NAgEustiCa/1_con_kien_2_con_kien/raw/main/tai_icon.png','9SmxltI','style','status','\x20/\x20','90GYQWSa','map','trim','stylesheet','89504e47','center','ZipWriter','img.lazy','BlobWriter','push','application/zip','2lnGjlU','18ikbONa','setAttribute','createElement','1446968bRGdMV','div','textContent','\x0a\x20\x20\x20\x20\x20\x20\x20\x20.status-num\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27Acme\x27,\x20sans-serif\x20!important;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-size:\x203rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20color:\x20#FD7377;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-webkit-text-stroke:\x201px\x20#C62428;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border:\x200.2rem\x20solid\x20#167975;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-radius:\x201rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding:\x200\x202rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-color:\x20#F9FDFD;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20box-shadow:\x200.25rem\x200.4rem\x20#2E8B87;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20min-height:\x204rem;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','innerHTML','flex','image/webp','status-num','URL','forEach','1355090uCTbJb','toString','14ksnZxA','querySelector','link','transform','heartbeat','data-src','body','width','appendChild','createObjectURL','className','image/jpeg','insertBefore','close','justifyContent','#heartbeat','absolute','.jpg','getUint32','position','1560204ArzmaB','52494646','2398IvSwuN','alignItems','1187523pFLDiz','firstChild','href','cursor','image/png','head','length','src','getAttribute','click','BlobReader','10000','1524TlvlGH','splice','.webp','blob','.webtoon-read-section','rel'];a0_0x126f=function(){return _0x1fcb0c;};return a0_0x126f();}const throttlePromises=async(_0x4b6a6f,_0x585e34)=>{const _0x25afeb=a0_0x4cf1;while(_0x4b6a6f[_0x25afeb(0x181)]>0x0){await Promise[_0x25afeb(0x19a)](_0x4b6a6f[_0x25afeb(0x188)](0x0,_0x585e34)['map'](_0x2b3a65=>_0x2b3a65())),await sleep(0xc8);}},on_heartbeat_css=()=>{const _0xc6a75d=a0_0x4cf1;let _0x411ffd=document['querySelector'](_0xc6a75d(0x172));!_0x411ffd&&(_0x411ffd=document[_0xc6a75d(0x1ae)]('style'),_0x411ffd[_0xc6a75d(0x1ad)]('id',_0xc6a75d(0x1bf)),document[_0xc6a75d(0x180)][_0xc6a75d(0x1c3)](_0x411ffd)),_0x411ffd[_0xc6a75d(0x1b1)]=_0xc6a75d(0x190);},off_heartbeat_css=()=>{const _0x30316e=a0_0x4cf1,_0x12be04=document[_0x30316e(0x1bc)](_0x30316e(0x172));_0x12be04[_0x30316e(0x1b1)]='';};function saveBlob(_0x2a3269,_0x1947ba){const _0x52d3f5=a0_0x4cf1,_0x21cb92=window[_0x52d3f5(0x1b7)][_0x52d3f5(0x1c4)](_0x2a3269),_0x34063f=document[_0x52d3f5(0x1ae)]('a');_0x34063f[_0x52d3f5(0x17d)]=_0x21cb92,_0x34063f['download']=_0x1947ba,_0x34063f[_0x52d3f5(0x19d)][_0x52d3f5(0x18f)]='none',document['body']['appendChild'](_0x34063f),_0x34063f['click'](),_0x34063f['remove'](),window['URL']['revokeObjectURL'](_0x21cb92),image_blobs=null;}((async()=>{const _0x514c3d=a0_0x4cf1,_0x42c7f9=[...document[_0x514c3d(0x1bc)](_0x514c3d(0x18b))[_0x514c3d(0x194)](_0x514c3d(0x1a7))][_0x514c3d(0x1a1)](_0x28bf7d=>!_0x28bf7d[_0x514c3d(0x183)](_0x514c3d(0x1c0))?_0x28bf7d[_0x514c3d(0x182)]:_0x28bf7d['getAttribute'](_0x514c3d(0x1c0))),_0x1f20fb=document[_0x514c3d(0x1bc)]('.title')['textContent'][_0x514c3d(0x1a2)]()['replace']('.','');if(_0x42c7f9[_0x514c3d(0x181)]>0x0){downloading_total=_0x42c7f9['length'];const _0x633ccd=create_download_icon();_0x633ccd[_0x514c3d(0x197)](_0x514c3d(0x184),async()=>{const _0x11e8d0=_0x514c3d;on_heartbeat_css(),downloading_current=0x0,image_blobs=[];const _0x41af3e=_0x42c7f9[_0x11e8d0(0x1a1)]((_0x22e237,_0x3f6628)=>()=>download(_0x22e237,_0x3f6628));await throttlePromises(_0x41af3e,0x4);const _0x4a4c72=new zip[(_0x11e8d0(0x1a8))](_0x11e8d0(0x1aa)),_0x5e93d8=new zip[(_0x11e8d0(0x1a6))](_0x4a4c72);let _0xa6cab4=image_blobs[_0x11e8d0(0x181)][_0x11e8d0(0x1ba)]()[_0x11e8d0(0x181)];image_blobs[_0x11e8d0(0x1b8)](async _0x1f9f73=>{const _0x4dc456=_0x11e8d0;await _0x5e93d8['add'](_0x1f9f73[_0x4dc456(0x18d)],new zip[(_0x4dc456(0x185))](_0x1f9f73[_0x4dc456(0x18a)]));});const _0x14e954=await _0x5e93d8[_0x11e8d0(0x170)]();saveBlob(_0x14e954,_0x1f20fb+_0x11e8d0(0x193));});}})());